<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			.div1{
				width: 100px;
				height: 100px;
				background-color: red;
			}
			.div2{
					width: 100%;
				height: 400px;
				background-color: black;
			}
		</style>
	</head>
	<body>
		
		<div class="div2">
				<div class="div1">
			
		</div>
		</div>
	
		
		
		  <script src="../../plugin/jquery/jquery.min.js"></script>
    <script src="new_file2.js"></script>
    <script>
    	
    	  window.requestAnimFrame = function () {
        return window.requestAnimationFrame || window.webkitRequestAnimationFrame || function (callback) {
            window.setTimeout(callback, 1000 / 60);
        };
    }();
    	$(function(){
    		 // drag;
			    var dragTrans = {
			        x: 0,
			        y: 0,
			        scale: 1,
			        rotate: 0
			    };
			      var $drag = $('.div1');
			     var freeze = false;
			      var wrap = document.querySelector('.div2');
			          var wrapRect = wrap.getBoundingClientRect();
    var elRect = $drag[0].getBoundingClientRect();
    		let mt = new MTouch(".div1");
			// bind the drag eventï¼›
		
			
			   mt.on('drag', function (ev) {
        if (!freeze) {
            dragTrans.x += ev.delta.deltaX;
            dragTrans.y += ev.delta.deltaY;
            set($drag, limit(wrap, $drag[0], dragTrans));
        }
    });
   function set($el, transform) {
        window.requestAnimFrame(function () {
            $el.css('transform', 'translate3d(' + transform.x + 'px,' + transform.y +
                'px,0px) rotate(' + transform.rotate + 'deg) scale(' + transform.scale + ')');
        });
    }
    mt.on('pinch singlePinch', function (ev) {
        if (!freeze) {
            dragTrans.scale *= ev.delta.scale;
            set($drag, dragTrans);
        }
    });
    mt.on('rotate singleRotate', function (ev) {
        if (!freeze) {
            dragTrans.rotate += ev.delta.rotate;
            set($drag, dragTrans);
        }
    });
    	    function limit(wrap, el, trans) {
        var bounce = 40;
        var minX = -el.offsetLeft - bounce;
        var maxX = wrapRect.width - el.offsetLeft - elRect.width + bounce;
        var minY = -el.offsetTop - bounce;
        var maxY = wrapRect.height - el.offsetTop - elRect.height + bounce;
        trans.x = trans.x < minX ? minX : trans.x;
        trans.x = trans.x > maxX ? maxX : trans.x;
        trans.y = trans.y < minY ? minY : trans.y;
        trans.y = trans.y > maxY ? maxY : trans.y;
        return trans;
    }
    
    
    	});
    	
    	
    
    </script>
	</body>
</html>
