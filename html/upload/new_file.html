<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1">
		<title>uploader</title>
		<link rel="stylesheet" href="/bower/ota.css/src/ota.css">
		<style>::-webkit-file-upload-button{cursor:pointer}.stage-open,body,html{width:100%;height:100%;overflow-x:hidden}.stage-open{display:-webkit-flex;display:-moz-flex;display:-ms-flex;display:-o-flex;display:flex;flex-direction:column;align-items:center;justify-content:center}.stage-open em{color:#62aaa0}.main{opacity:0;-webkit-transition:.5s;transition:.5s;background:url(http://7xlnuf.com1.z0.glb.clouddn.com/26238f278fd93aff.jpg) center center no-repeat;background-size:cover;height:100%}.result{display:-webkit-flex;display:flex;align-items:center}.main{display:-webkit-flex;display:-moz-flex;display:-ms-flex;display:-o-flex;display:flex;justify-content:center;align-items:center}.main section{width:40%;margin:0 2%}.wrap{position:relative;-webkit-transition:.5s;transition:.5s}.wrap:hover{box-shadow:0 0 50px rgba(255,255,255,.5)}.fake{height:350px;margin:0 auto;opacity:.7;position:relative;-webkit-transition:.3s;transition:.3s;cursor:pointer;background-size:cover;background-position:center center;background-repeat:no-repeat}.fake input[type=file]{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;cursor:pointer}.fake[data-type=tietuku]{background-color:#090}.fake[data-type=imgur]::after,.fake[data-type=sina]::after,.fake[data-type=smms]::after,.fake[data-type=tietuku]::after{white-space:nowrap;color:#fff;text-align:center;position:absolute;top:50%;left:50%;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0);font-size:42px;z-index:0}.fake[data-type=tietuku]::after{content:'贴图库'}.fake[data-type=imgur]{background-color:#111}.fake[data-type=imgur]::after{content:'imgur'}.fake[data-type=sina]{background-color:#ff8140}.fake[data-type=sina]::after{content:'sina'}.fake[data-type=smms]{background-color:#555}.fake[data-type=smms]::after{content:'smms'}.result-txt{flex:2;height:40px}.result button{height:40px}.spinner{height:80px;text-align:center;font-size:10px;position:absolute;top:50%;left:50%;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0);display:none}.loading .spinner{display:block}.loading .fake::after{content:''}.spinner>div{background-color:#fff;height:100%;width:10px;display:inline-block;margin:0 3px;-webkit-animation:sk-stretchdelay 1.2s infinite ease-in-out;animation:sk-stretchdelay 1.2s infinite ease-in-out}.spinner .rect2{-webkit-animation-delay:-1.1s;animation-delay:-1.1s}.spinner .rect3{-webkit-animation-delay:-1s;animation-delay:-1s}.spinner .rect4{-webkit-animation-delay:-.9s;animation-delay:-.9s}.spinner .rect5{-webkit-animation-delay:-.8s;animation-delay:-.8s}@-webkit-keyframes sk-stretchdelay{0%,100%,40%{-webkit-transform:scaleY(.4)}20%{-webkit-transform:scaleY(1)}}@keyframes sk-stretchdelay{0%,100%,40%{transform:scaleY(.4);-webkit-transform:scaleY(.4)}20%{transform:scaleY(1);-webkit-transform:scaleY(1)}}.toast{position:fixed;left:50%;bottom:0;-webkit-transform:translate3d(-50%,60px,0);transform:translate3d(-50%,60px,0);white-space:nowrap;width:100%;height:60px;color:#fff;background:rgba(233,30,99,.71);transition:.3s;text-align:center;font-size:20px;line-height:60px}.toast.show{-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0)}@media screen and (max-width:950px){.main{flex-direction:column;height:auto}.main section{width:80%;margin:3% 0}}</style>
	</head>
	<body>
		<div class="stage-open">
			<h1><em>U</em>pload</h1>
			<p>加载中...</p>
		</div>
		<div class="main">
			<section data-rel="imgur">
				<div class="wrap">
					<div class="fake" data-type="imgur"><input type="file" name="img" data-type="imgur">
						<div class="spinner">
							<div class="rect1"></div>
							<div class="rect2"></div>
							<div class="rect3"></div>
							<div class="rect4"></div>
							<div class="rect5"></div>
						</div>
					</div>
					<div class="result"><input type="text" class="result-txt" data-rel="imgur"> <button class="copy"
						 data-clipboard-target="input[data-rel=imgur]">复制地址</button></div>
				</div>
			</section>
			<section data-rel="sina">
				<div class="wrap">
					<div class="fake" data-type="sina"><input type="file" name="img" data-type="sina">
						<div class="spinner">
							<div class="rect1"></div>
							<div class="rect2"></div>
							<div class="rect3"></div>
							<div class="rect4"></div>
							<div class="rect5"></div>
						</div>
					</div>
					<div class="result"><input type="text" class="result-txt" data-rel="sina"> <button class="copy"
						 data-clipboard-target="input[data-rel=sina]">复制地址</button></div>
				</div>
			</section>
			<section data-rel="smms">
				<div class="wrap">
					<div class="fake" data-type="smms"><input type="file" name="img" data-type="smms">
						<div class="spinner">
							<div class="rect1"></div>
							<div class="rect2"></div>
							<div class="rect3"></div>
							<div class="rect4"></div>
							<div class="rect5"></div>
						</div>
					</div>
					<div class="result"><input type="text" class="result-txt" data-rel="smms"> <button class="copy"
						 data-clipboard-target="input[data-rel=smms]">复制地址</button></div>
				</div>
			</section>
		</div>
		<div class="toast"></div>
	</body>
	<script src="http://upload.otar.im/bower/clipboard/dist/clipboard.min.js"></script>
	<script>
		var upload = function() {
				var e = function(e) {
					return new Promise(function(t, n) {
						var o = new XMLHttpRequest,
							r = new FormData;
						o.open("post", e.url, !0), o.setRequestHeader("x-csrf-token", "wtOlZ0J2-0PE_k8PWlGJ4mhGRrqOy-8ya_oA"), o.onload =
							function() {
								try {
									var e = JSON.parse(this.responseText);
									return e.url ? t(e) : n(err)
								} catch (e) {
									return n(e)
								}
							}, o.onerror = function(e) {
								return n(e)
							};
						for (var a in e.formData) r.append(a, e.formData[a]);
						o.send(r)
					})
				};
				return function(t, n) {
					n && checkImg(n) && (document.querySelector("section[data-rel=" + t + "]").classList.toggle("loading"), e({
						url: "/api/upload/" + t,
						formData: {
							img: n
						}
					}).then(function(e) {
						document.querySelector(".fake[data-type=" + t + "]").style.backgroundImage = "url(" + e.url + ")", document.querySelector(
							"section[data-rel=" + t + "]").classList.toggle("loading"), document.querySelector("input[data-rel=" + t +
							"]").value = e.url
					}, function(e) {
						document.querySelector("section[data-rel=" + t + "]").classList.toggle("loading"), toast("发生未知错误，上传失败:-("),
							document.querySelector("input[data-rel=" + t + "]").value = ""
					}))
				}
			}(),
			toast = function() {
				var e, t = document.querySelector(".toast"),
					n = function() {
						clearTimeout(e), e = setTimeout(function() {
							this.classList.remove("show")
						}.bind(this), 1500)
					};
				return t.addEventListener("transitionend", n), t.addEventListener("webkitTransitionEnd", n),
					function(e) {
						t.innerText = e, t.classList.add("show")
					}
			}(),
			preload = function(e) {
				var t = ["http://7xlnuf.com1.z0.glb.clouddn.com/26238f278fd93aff.jpg"],
					n = t.length,
					o = function() {
						0 === --n && e && e()
					};
				t.forEach(function(e) {
					var t = new Image;
					t.onload = t.onerror = function() {
						o()
					}, t.src = e
				})
			},
			checkImg = function(e) {
				return /jpeg|jpg|png|gif|bmp/.test(e.type) ? !(e.size > 5242880) || (toast("图片体积不能大于5M"), !1) : (toast(
					"请选择正确的图片格式「支持jpeg|jpg|png|gif|bmp」"), !1)
			};
		preload(function() {
			new Clipboard("button"), document.querySelector(".stage-open").style.display = "none", document.querySelector(
				".main").style.opacity = 1, [].slice.call(document.querySelectorAll("[type=file]")).forEach(function(e) {
				e.addEventListener("change", function(e) {
					e.stopPropagation();
					e.target.dataset.event;
					var t = e.target.dataset.type,
						n = e.target.files[0];
					return upload(t, n)
				}, !1)
			}), [].slice.call(document.querySelectorAll(".fake")).forEach(function(e) {
				e.addEventListener("drop", function(e) {
					e.stopPropagation(), e.preventDefault();
					var t = e.target.dataset.type,
						n = e.dataTransfer.files[0];
					return upload(t, n)
				}, !1), e.addEventListener("dragover", function(e) {
					e.stopPropagation(), e.preventDefault(), e.dataTransfer.dropEffect = "copy"
				}, !1)
			})
		})
	</script>
</html><strong></strong>
